<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Network Layer || IP Addressing - COMP3331 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="Application -&amp;gt; Transport -&amp;gt; Network -&amp;gt; Data Link -&amp;gt; Physical"><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/network-layer-and-ip/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content="Network Layer || IP Addressing"><meta property=og:description content="Application -&gt; Transport -&gt; Network -&gt; Data Link -&gt; Physical"><meta property=og:type content=article><meta property=og:url content=/post/network-layer-and-ip/><meta property=article:published_time content=2020-04-26T00:39:47+10:00><meta property=article:modified_time content=2020-04-26T00:39:47+10:00><meta itemprop=name content="Network Layer || IP Addressing"><meta itemprop=description content="Application -&gt; Transport -&gt; Network -&gt; Data Link -&gt; Physical"><meta itemprop=datePublished content=2020-04-26T00:39:47&#43;10:00><meta itemprop=dateModified content=2020-04-26T00:39:47&#43;10:00><meta itemprop=wordCount content=924><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="Network Layer || IP Addressing"><meta name=twitter:description content="Application -&gt; Transport -&gt; Network -&gt; Data Link -&gt; Physical"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP3331 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP3331><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP3331 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP3331>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Network Layer || IP Addressing</h1><div class=post-meta><span class=post-time>2020-04-26</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#routers>Routers</a></li><li><a href=#ip-packet-structure>IP Packet Structure</a></li><li><a href=#ttl>TTL</a></li><li><a href=#header-corruption>Header Corruption</a></li><li><a href=#fragmentation>Fragmentation</a><ul><li><a href=#fragments>Fragments</a></li></ul></li><li><a href=#mtu-discovery>MTU Discovery</a></li><li><a href=#ip-addresses>IP Addresses</a><ul><li><a href=#network-masks>Network Masks</a><ul><li><a href=#network-address>Network Address</a></li><li><a href=#broadcast-address>Broadcast Address</a></li></ul></li><li><a href=#network-classes-old>Network Classes (old)</a></li><li><a href=#subnets>Subnets</a></li><li><a href=#cidr-classless-inter-domain-routing>CIDR - Classless Inter-Domain Routing</a></li><li><a href=#allocation-of-ip-addressess>Allocation of IP Addressess</a><ul><li><a href=#block-allocation>Block Allocation</a></li><li><a href=#dynamic-host-configuration-protocol-dhcp>Dynamic Host Configuration Protocol - DHCP</a></li></ul></li><li><a href=#hierarchical-addressing-route-aggregation>Hierarchical addressing: route aggregation</a></li><li><a href=#network-address-translation-nat>Network Address Translation (NAT)</a><ul><li><a href=#static-configuration>Static Configuration</a></li><li><a href=#dynamic-configuration-upnp>Dynamic Configuration - UPnP</a></li><li><a href=#nat-is-controversial>NAT is Controversial</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-content><blockquote><p>Application -&gt; Transport -&gt; <strong>Network</strong> -&gt; Data Link -&gt; Physical</p></blockquote><h1 id=routers>Routers</h1><ul><li>Routing - The route a packet takes from source to destination</li><li><p>Forwarding - The next direction a packet takes</p></li><li><p>Data plane - Local operation of the packet (Within the deive)</p></li><li><p>Control plane - Global operation of the packet (Between devices)</p></li></ul><h1 id=ip-packet-structure>IP Packet Structure</h1><p>Version, header length, type, length, id, flags, fragment offset, ttl value, protocol, checksum, source address, destination address, options, payload</p><ul><li>Version (4 bits) - IP version - usually 4 for IPv4</li><li>Header length (4 bits) - Number of 32-bit words in the header<ul><li>Usually <code>5</code> (for 5 x 32bit words = 5 * 4 bytes = 20 bytes)</li></ul></li><li>Type of Service - TOS (8 bits) - Special flags (i.e. low latency audio)</li><li>Total length (16 bits) - number of bytes in the packet (max 65535)</li><li>TTL (8 bits) - Remaining hops before the packet is discarded<ul><li>Set to 255 (0xFF) initially</li><li>Decreases by one each time the packet is forwarded</li><li>Discarded when the TTL is 0</li></ul></li><li>Protocol (8 bits) - Identifies the Transport protocol - i.e. TCP/UDP/ICMP/etc</li></ul><h1 id=ttl>TTL</h1><p>Packets may be forwarded in a circle, and never reach their destination.<br>To stop a packet from being constantly circulated; the packet has a Time To Live value, which limits the number of forwards it may take.</p><h1 id=header-corruption>Header Corruption</h1><p>A checksum is used to verify that the header data has not been corrupted during transmission.<br>If the checksum is invalid, the packet is discarded.</p><p>Only the header is checked, as the transport layer protocol has its own checksum</p><h1 id=fragmentation>Fragmentation</h1><p>Each layer has its own maximum packet size. Encapsulated packets are split into chunks of these maximum sizes, allowing them to be transmitted over the network. This is known as fragmentation.</p><p>i.e. The Ethernet protocol has an MTU (maximum transmission unit) size of 1500 bytes - so any TCP packet larger than 1500 bytes will be split into several fragments</p><p>Fragments are reassembled at the destination, and are grouped together by the IP header bits (ie id, and fragmentation offset)</p><h2 id=fragments>Fragments</h2><p>Fragments will have an <code>id</code>, <code>fragmentation offset</code> value and a <code>more fragments</code> flag to indicate the group and metadata of the packet.</p><p>Fragments may be re-fragmented as they go down the OSI layer stack.</p><h1 id=mtu-discovery>MTU Discovery</h1><p>A host will send a large packet with the <code>Do Not Fragment (DF)</code> flag.<br>Routers along the network will attempt to route the packet.<br>If they cannot handle the packet size, they will drop the packet, and send an <code>ICMP</code> message to the host with their maximum supported size.</p><h1 id=ip-addresses>IP Addresses</h1><ul><li>IP Address: 32 bit value to identify a host to the router interface</li><li>Interface - Connection between host/router and a physical link</li></ul><h2 id=network-masks>Network Masks</h2><p>Used to indicate how many higher order bits are used for the network identification, and how many low order bits are used for the host identification</p><h3 id=network-address>Network Address</h3><p>The network address is a special address where all of the host bits are <code>0</code></p><h3 id=broadcast-address>Broadcast Address</h3><p>The broadcast address is a special host address, where all the host bits are <code>0</code></p><h2 id=network-classes-old>Network Classes (old)</h2><ul><li>Class A - 8 bits | 24 bits</li><li>Class B - 16 bits | 16 bits</li><li>Class C - 24 bits | 8 bits</li><li>Class D - Multicast</li><li><p>Class D - Reserved</p></li><li><p>Identify by how many 1s are consecutive from the very start</p></li></ul><h2 id=subnets>Subnets</h2><p>Divides a network internally into smaller network.</p><p>This is done by splitting the host bits into <code>subnet bits</code> and the remaining <code>host bits</code></p><p><img src="Screenshot from 2020-04-26 01-15-37.png" alt></p><ul><li>Transparent - A device outside of this network won&rsquo;t see any difference</li></ul><h2 id=cidr-classless-inter-domain-routing>CIDR - Classless Inter-Domain Routing</h2><p>Format <code>a.b.c.d/x</code> where <code>x</code> is the number of network bits</p><h2 id=allocation-of-ip-addressess>Allocation of IP Addressess</h2><h3 id=block-allocation>Block Allocation</h3><p>An organisation becomes a subnet of the ISP&rsquo;s network</p><h3 id=dynamic-host-configuration-protocol-dhcp>Dynamic Host Configuration Protocol - DHCP</h3><p>DHCP Servers that allocate IP address to clients.</p><ul><li>Clients send <code>DHCP Discover</code> - To find DHCP servers</li><li>Servers send <code>DHCP Offer</code> - To advertise server</li><li>Clients send <code>DHCP Request</code> - To request for an IP</li><li>Servers send <code>DHCP Acknowledgement</code> - To assign an IP</li></ul><p>DHCP Servers can also supply more information, such as the suggested DNS server, subnet mask, and gateway IP (first hop for client).</p><p>The DHCP protocol uses UDP Port 67 (Server) and 68 (Client).
The MAC address of the client is used to identify themselves.</p><h2 id=hierarchical-addressing-route-aggregation>Hierarchical addressing: route aggregation</h2><p>An advertised route with a more specific route (more network bits than host bits // longest prefix matching) will receive the forward</p><h2 id=network-address-translation-nat>Network Address Translation (NAT)</h2><p>A router is often the only device that faces the internet, with client devices connected locally.<br>As a result, devices on the internet cannot directly connect to the client devices.</p><p>Instead, packets are sent to the router, which will perform Network Address Translation to forward the packet to the client, and also to forward the packets from the client.</p><p>With this, the source and destination IPs and Ports are remapped.</p><ul><li>Outgoing datagrams -&gt; Replace source IP and port with NAT IP and port</li><li>Incoming datagrams -&gt; Replace NAT IP and port with Source IP and Port</li></ul><blockquote><p>i.e. A NAT may translate 110.20.160.140:1701 to 192.168.1.80:80, and 11.20.160.140:1702 to 192.168.1.58:80.</p></blockquote><p>Consequently, changes to the internal network will not be seen by external devices.</p><h3 id=static-configuration>Static Configuration</h3><p>i.e. Port Forwarding</p><h3 id=dynamic-configuration-upnp>Dynamic Configuration - UPnP</h3><p>NATs will learn the public IP and dynamically add/remove ports</p><h3 id=nat-is-controversial>NAT is Controversial</h3><ul><li>Violates design of a router - Process up to Layer 3 and not look at Layer 4 (IP)</li><li>Application designs must take into account the possible existence of NAT<ul><li>P2P</li><li>Holepunching</li></ul></li></ul><p>&hellip; meh</p></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/tcp/><i class="iconfont icon-left"></i><span class="prev-text nav-default">TCP Protocol</span>
<span class="prev-text nav-mobile">Prev</span></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>