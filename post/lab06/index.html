<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Lab 06 - Throughput, IP Fragmentation and Routing - COMP3331 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="Exercise 1: Setting up NS2 simulation for measuring TCP throughput  File: exercise2."><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/lab06/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content="Lab 06 - Throughput, IP Fragmentation and Routing"><meta property=og:description content="Exercise 1: Setting up NS2 simulation for measuring TCP throughput  File: exercise2."><meta property=og:type content=article><meta property=og:url content=/post/lab06/><meta property=article:published_time content=2020-04-12T21:18:52+10:00><meta property=article:modified_time content=2020-04-12T21:18:52+10:00><meta itemprop=name content="Lab 06 - Throughput, IP Fragmentation and Routing"><meta itemprop=description content="Exercise 1: Setting up NS2 simulation for measuring TCP throughput  File: exercise2."><meta itemprop=datePublished content=2020-04-12T21:18:52&#43;10:00><meta itemprop=dateModified content=2020-04-12T21:18:52&#43;10:00><meta itemprop=wordCount content=1156><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="Lab 06 - Throughput, IP Fragmentation and Routing"><meta name=twitter:description content="Exercise 1: Setting up NS2 simulation for measuring TCP throughput  File: exercise2."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP3331 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP3331><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP3331 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP3331>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Lab 06 - Throughput, IP Fragmentation and Routing</h1><div class=post-meta><span class=post-time>2020-04-12</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#exercise-1-setting-up-ns2-simulation-for-measuring-tcp-throughput>Exercise 1: Setting up NS2 simulation for measuring TCP throughput</a><ul><li><a href=#why-is-the-throughput-achieved-by-flow-tcp2-higher-than-tcp1-between-time-span-6-sec-to-8-sec>Why is the throughput achieved by flow tcp2 higher than tcp1 between time span 6 sec to 8 sec?</a></li><li><a href=#why-is-the-throughput-for-flow-tcp1-fluctuating-between-time-span-0-5-sec-to-2-sec>Why is the throughput for flow tcp1 fluctuating between time span 0.5 sec to 2 sec?</a></li><li><a href=#why-is-the-maximum-throughput-achieved-by-any-one-flow-capped-at-around-1-5mbps>Why is the maximum throughput achieved by any one flow capped at around 1.5Mbps?</a></li></ul></li><li><a href=#exercise-2-understanding-ip-fragmentation>Exercise 2: Understanding IP Fragmentation</a><ul><li><a href=#which-data-size-has-caused-fragmentation-and-why>Which data size has caused fragmentation and why?</a><ul><li><a href=#which-host-router-has-fragmented-the-original-datagram>Which host/router has fragmented the original datagram?</a></li><li><a href=#how-many-fragments-have-been-created-when-data-size-is-specified-as-2000>How many fragments have been created when data size is specified as 2000?</a></li></ul></li><li><a href=#did-the-reply-from-the-destination-8-8-8-8-for-3500-byte-data-size-also-get-fragmented-why-or-why-not>Did the reply from the destination 8.8.8.8. for 3500-byte data size also get fragmented? Why or why not?</a></li><li><a href=#give-the-id-length-flag-and-offset-values-for-all-the-fragments-of-the-first-packet-sent-by-192-168-1-103-with-data-size-of-3500-bytes>Give the ID, length, flag and offset values for all the fragments of the first packet sent by 192.168.1.103 with data size of 3500 bytes?</a></li><li><a href=#has-fragmentation-of-fragments-occurred-when-data-of-size-3500-bytes-has-been-used-why-and-why-not>Has fragmentation of fragments occurred when data of size 3500 bytes has been used? Why and why not?</a></li><li><a href=#what-will-happen-if-for-our-example-one-fragment-of-the-original-datagram-from-192-168-1-103-is-lost>What will happen if for our example one fragment of the original datagram from 192.168.1.103 is lost?</a></li></ul></li><li><a href=#exercise-3-understanding-the-impact-of-network-dynamics-on-routing>Exercise 3: Understanding the Impact of Network Dynamics on Routing</a><ul><li><a href=#which-nodes-communicate-with-which-other-nodes-which-route-do-the-packets-follow-does-it-change-over-time>Which nodes communicate with which other nodes? Which route do the packets follow? Does it change over time?</a></li><li><a href=#what-happens-at-time-1-0-and-at-time-1-2-does-the-route-between-the-communicating-nodes-change-as-a-result-of-that>What happens at time 1.0 and at time 1.2? Does the route between the communicating nodes change as a result of that?</a></li><li><a href=#did-you-observe-any-additional-traffic-when-rtproto-was-set-to-dv-how-does-the-network-react-to-the-changes-that-take-place-at-time-1-0-and-time-1-2-now>Did you observe any additional traffic when rtproto was set to DV? How does the network react to the changes that take place at time 1.0 and time 1.2 now?</a></li><li><a href=#when-the-cost-of-link-1-4-is-set-to-3-how-does-this-change-affect-the-routing-explain-why>When the cost of link 1-4 is set to 3, how does this change affect the routing? Explain why.</a></li><li><a href=#when-the-cost-of-link-1-4-is-set-to-2-and-link-3-5-is-set-to-3-describe-what-happens-and-deduce-the-effect-of-node-set-multipath-1>When the cost of link 1-4 is set to 2, and link 3-5 is set to 3, describe what happens and deduce the effect of <code>Node set multiPath_ 1</code></a></li></ul></li></ul></nav></div></div><div class=post-content><h1 id=exercise-1-setting-up-ns2-simulation-for-measuring-tcp-throughput>Exercise 1: Setting up NS2 simulation for measuring TCP throughput</h1><ul><li>File: <a href=./exercise2.tcl>exercise2.tcl</a></li><li>File: <a href=./throughput.plot>throughput.plot</a></li></ul><p><img src=Picture1.png alt></p><ul><li>FTP/TCP Source n0 -&gt; TCP Sink n5 : start time: 0.5 sec End time: 8.5 sec</li><li>FTP/TCP Source n3 -&gt; TCP Sink n5 : start time: 2.0 sec End time: 9.5 sec</li><li>FTP/TCP Source n7 -&gt; TCP Sink n0 : start time: 3.0 sec End time: 9.5 sec</li><li>FTP/TCP Source n7 -&gt; TCP Sink n3 : start time: 4.0 sec End time: 7.0 sec</li></ul><table><thead><tr><th align=center>nam</th><th align=center>gnuplot</th></tr></thead><tbody><tr><td align=center><img src="Screenshot from 2020-04-12 23-41-57.png" alt></td><td align=center><img src="Screenshot from 2020-04-12 23-50-52.png" alt></td></tr></tbody></table><h2 id=why-is-the-throughput-achieved-by-flow-tcp2-higher-than-tcp1-between-time-span-6-sec-to-8-sec>Why is the throughput achieved by flow tcp2 higher than tcp1 between time span 6 sec to 8 sec?</h2><p><img src="Screenshot from 2020-04-13 00-04-06.png" alt>
<em>Visualisation of traffic at 6-8s</em></p><ul><li>TCP1 flows from 0-1, 1-2, 2-4, 4-5</li><li>TCP2 flows from 3-2, 2-4, 4-5</li><li>TCP3 flows from 7-6, 6-1, 1-0</li><li>TCP4 flows from 7-6, 6-1, 1-2, 2-3</li></ul><p><strong><em><u>NOTE: I am only considering the 2.5Mbps links as there are no issues on the 10Mbps links&hellip;</u></em></strong></p><p>At the time span from 6 to 8 seconds, TCP1 must share the link bandwidth of 1-2 with TCP4
It must also share the link bandwidth of 2-4 with TCP2</p><p>At the time span from 6 to 8 seconds, TCP2 only needs to share the link bandwidth of 2-4 with TCP1.</p><ul><li>The RTT for TCP1 is <code>2 x (10 + 40 + 40 + 10) = 200ms</code><br></li><li>The RTT for TCP2 is <code>2 x (10 + 40 + 10) = 120ms</code><br></li></ul><p>As RTT2 has a lower RTT, it is allocated a higher portion of the bandwidth, hence the throughput achieved by flow TCP2 is higher</p><h2 id=why-is-the-throughput-for-flow-tcp1-fluctuating-between-time-span-0-5-sec-to-2-sec>Why is the throughput for flow tcp1 fluctuating between time span 0.5 sec to 2 sec?</h2><p>At the time span from 0.5 to 2 seconds, flow TCP1 is performing the TCP Slow Start mechanism to check the available bandwidth</p><h2 id=why-is-the-maximum-throughput-achieved-by-any-one-flow-capped-at-around-1-5mbps>Why is the maximum throughput achieved by any one flow capped at around 1.5Mbps?</h2><p>The maximum throughput is the capacity of the smallest link - in this case 2.5Mbps.<br>As TCP1 performs a Slow Slart algorithm, by the time it reaches a window of 1.5Mbps, TCP2 starts its activity; which prevents TCP1 from acquiring any further bandwidth.</p><p>Hence flow TCP1, and the other flows will never be able to utilise 2.5Mbps on their own, and are capped at 1.5Mbps</p><h1 id=exercise-2-understanding-ip-fragmentation>Exercise 2: Understanding IP Fragmentation</h1><p>File: <a href=./ip_frag.pcapng>ip_frag.pcapng</a></p><h2 id=which-data-size-has-caused-fragmentation-and-why>Which data size has caused fragmentation and why?</h2><p><img src="Screenshot from 2020-04-13 00-32-41.png" alt></p><p>The data size of 2000 bytes (and consequently 3000 bytes) has caused fragmentation, as the default MTU for an Ethernet frame is 1500 bytes.<br>As the packet was larger than the MTU, it was split up.</p><h3 id=which-host-router-has-fragmented-the-original-datagram>Which host/router has fragmented the original datagram?</h3><p>The source (<code>192.168.1.103</code>) fragmented the original datagram.</p><h3 id=how-many-fragments-have-been-created-when-data-size-is-specified-as-2000>How many fragments have been created when data size is specified as 2000?</h3><p><code>2 fragments</code> were created for each ping with data sizes of 2000 bytes.</p><p>For example, packet 16 and packet 17.<br>Whilst only packet 16 says &ldquo;Fragmented IP Protocol&rdquo;, packet 17 is the other fragment, which gets combined.</p><h2 id=did-the-reply-from-the-destination-8-8-8-8-for-3500-byte-data-size-also-get-fragmented-why-or-why-not>Did the reply from the destination 8.8.8.8. for 3500-byte data size also get fragmented? Why or why not?</h2><p>Yes, the reply for the ping of 3500 byte data size was also fragmented (into 3), as all packets must adhere to the Ethernet MTU of 1500 bytes.</p><p>i.e. packets 42, 43 and 44</p><h2 id=give-the-id-length-flag-and-offset-values-for-all-the-fragments-of-the-first-packet-sent-by-192-168-1-103-with-data-size-of-3500-bytes>Give the ID, length, flag and offset values for all the fragments of the first packet sent by 192.168.1.103 with data size of 3500 bytes?</h2><p><img src="Screenshot from 2020-04-13 00-47-07.png" alt></p><p><strong><em><u>NOTE: Length is given by the payload length (ICMP data)</u></em></strong></p><table><thead><tr><th align=center>Packet Number</th><th align=center><code>ip.id</code></th><th align=center>IP Length</th><th align=center>Payload Length</th><th align=center>Flag</th><th align=center>Offset</th></tr></thead><tbody><tr><td align=center>39</td><td align=center>0x7a7b</td><td align=center>1500</td><td align=center>1480</td><td align=center>More Fragments</td><td align=center>Fragment offset 0</td></tr><tr><td align=center>40</td><td align=center>0x7a7b</td><td align=center>1500</td><td align=center>1480</td><td align=center>More Fragments</td><td align=center>Fragment offset 185</td></tr><tr><td align=center>41</td><td align=center>0x7a7b</td><td align=center>568</td><td align=center>548</td><td align=center>-</td><td align=center>Fragment offset 370</td></tr></tbody></table><h2 id=has-fragmentation-of-fragments-occurred-when-data-of-size-3500-bytes-has-been-used-why-and-why-not>Has fragmentation of fragments occurred when data of size 3500 bytes has been used? Why and why not?</h2><p>No, fragments were not re-fragmented.</p><p>It is the sender&rsquo;s responsibility to split the original packet into the right fragment sizes that are at most 1500 bytes long.<br>Therefore fragments will not be refragmented</p><h2 id=what-will-happen-if-for-our-example-one-fragment-of-the-original-datagram-from-192-168-1-103-is-lost>What will happen if for our example one fragment of the original datagram from 192.168.1.103 is lost?</h2><p>If one fragment is lost, all fragments will need to be retransmitted.</p><h1 id=exercise-3-understanding-the-impact-of-network-dynamics-on-routing>Exercise 3: Understanding the Impact of Network Dynamics on Routing</h1><p>File: <a href=./tp_routing-step1.tcl>tp_routing-step1.tcl</a><br>File: <a href=./tp_routing-step2.tcl>tp_routing-step2.tcl</a><br>File: <a href=./tp_routing-step3.tcl>tp_routing-step3.tcl</a><br>File: <a href=./tp_routing-step4.tcl>tp_routing-step4.tcl</a><br>File: <a href=./tp_routing-step5.tcl>tp_routing-step5.tcl</a></p><p><img src=Screen_Shot_2016-09-06_at_5.43.33_PM.png alt></p><h2 id=which-nodes-communicate-with-which-other-nodes-which-route-do-the-packets-follow-does-it-change-over-time>Which nodes communicate with which other nodes? Which route do the packets follow? Does it change over time?</h2><ul><li>Node 0 communicates with Node 5 via 0-1-4-5</li><li>Node 2 communicates with Node 5 via 2-3-5</li></ul><p>The route doesn&rsquo;t change over the duration of the simulation</p><h2 id=what-happens-at-time-1-0-and-at-time-1-2-does-the-route-between-the-communicating-nodes-change-as-a-result-of-that>What happens at time 1.0 and at time 1.2? Does the route between the communicating nodes change as a result of that?</h2><p>At time 1.0s, the link 1-4 is disabled - the data coming from node 0 is lost, as the data is not rerouted nor retransmitted.</p><p>At time 1.2s, the link 1-4 is enabled - the data coming from node 0 is passed along to node 4 and then to node 5.</p><p>Node 2&rsquo;s communication to Node 5 remains unaffected throughout the simulation</p><h2 id=did-you-observe-any-additional-traffic-when-rtproto-was-set-to-dv-how-does-the-network-react-to-the-changes-that-take-place-at-time-1-0-and-time-1-2-now>Did you observe any additional traffic when rtproto was set to DV? How does the network react to the changes that take place at time 1.0 and time 1.2 now?</h2><blockquote><p>As the simulation starts, node 0 sends out some data to node 1.<br>A short while after node 2 sends out some data to node 1 and node 3.<br>&nbsp;<br>Nodes 1 then transmits some data to nodes 0 and 4,<br>and node 3 transmits some data to node 5 and 2.
&nbsp;<br>Each node then transmits some data along each of its links.</p></blockquote><p>This occurs frequently.</p><p>At time 1.0s, when link 1-4 is disabled, this behaviour is also seen.<br>The network reacts by rerouting the packets from 0-1-4-5 to 0-1-2-3-5.</p><p>At time 1.2s, link 1-4 is enabled, and routes the packets from node 0 back to the original path of 0-1-4-5.</p><h2 id=when-the-cost-of-link-1-4-is-set-to-3-how-does-this-change-affect-the-routing-explain-why>When the cost of link 1-4 is set to 3, how does this change affect the routing? Explain why.</h2><p>All of the packets sent from node 0 are no longer routed through node 4, but instead follow the path 0-1-2-3-5.<br>This is because node 1 has decided that it is cheaper to get to node 5 via 1-2-3-5 (cost = 3), rather than 1-4-5 (cost = 4).</p><h2 id=when-the-cost-of-link-1-4-is-set-to-2-and-link-3-5-is-set-to-3-describe-what-happens-and-deduce-the-effect-of-node-set-multipath-1>When the cost of link 1-4 is set to 2, and link 3-5 is set to 3, describe what happens and deduce the effect of <code>Node set multiPath_ 1</code></h2><p>Data from node 0 travels to node 5 via the route 0-1-4-5.<br>Data from node 2 travels to node 5 via alternating routes 2-3-5 (first), then 2-1-4-5.</p><ul><li>When the cost of link 1-4 is 2; route 2-1-4-5 will have a cost of 4.<br></li><li>When the cost of link 3-5 is 3; route 2-3-5 will have the same cost of 4.</li></ul><p>The <code>Node set multiPath_ 1</code> option allows nodes to load balance their traffic unto multiple routes, such as what node 2 is doing.</p></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/lab05/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Lab 05 - TCP Congestion Control and Fairness</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../post/lab07/><span class="next-text nav-default">Lab 07 - NAT, Ethernet and ARP</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>