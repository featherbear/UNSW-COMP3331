<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Lab 07 - NAT, Ethernet and ARP - COMP3331 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="Exercise 1: Understanding NAT using Wireshark File: NAT_home_side."><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/lab07/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content="Lab 07 - NAT, Ethernet and ARP"><meta property=og:description content="Exercise 1: Understanding NAT using Wireshark File: NAT_home_side."><meta property=og:type content=article><meta property=og:url content=/post/lab07/><meta property=article:published_time content=2020-04-19T16:13:11+10:00><meta property=article:modified_time content=2020-04-19T16:13:11+10:00><meta itemprop=name content="Lab 07 - NAT, Ethernet and ARP"><meta itemprop=description content="Exercise 1: Understanding NAT using Wireshark File: NAT_home_side."><meta itemprop=datePublished content=2020-04-19T16:13:11&#43;10:00><meta itemprop=dateModified content=2020-04-19T16:13:11&#43;10:00><meta itemprop=wordCount content=1387><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="Lab 07 - NAT, Ethernet and ARP"><meta name=twitter:description content="Exercise 1: Understanding NAT using Wireshark File: NAT_home_side."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP3331 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP3331><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP3331 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP3331>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Lab 07 - NAT, Ethernet and ARP</h1><div class=post-meta><span class=post-time>2020-04-19</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#exercise-1-understanding-nat-using-wireshark>Exercise 1: Understanding NAT using Wireshark</a><ul><li><a href=#what-is-the-ip-address-of-the-client>What is the IP address of the client?</a></li><li><a href=#at-time-7-109267-56-what-are-the-source-and-destination-ip-addresses-and-tcp-source-and-destination-ports-on-the-ip-datagram-carrying-this-http-get>At time 7.109267 (#56), what are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP GET?</a></li><li><a href=#at-what-time-is-the-corresponding-200-ok-http-message-received-from-the-google-server>At what time is the corresponding 200 OK HTTP message received from the Google server?</a></li><li><a href=#at-what-time-is-the-client-to-server-tcp-syn-segment-sent-that-sets-up-the-connection-used-by-the-get-sent-at-time-7-109267-what-are-the-source-and-destination-ip-addresses-and-source-and-destination-ports-for-the-tcp-syn-segment>At what time is the client-to-server TCP SYN segment sent that sets up the connection used by the GET sent at time 7.109267? What are the source and destination IP addresses and source and destination ports for the TCP SYN segment?</a></li><li><a href=#what-are-the-source-and-destination-ip-addresses-and-source-and-destination-ports-of-the-ack-sent-in-response-to-the-syn-at-what-time-is-this-syn-ack-received-at-the-client>What are the source and destination IP addresses and source and destination ports of the ACK sent in response to the SYN. At what time is this SYN/ACK received at the client?</a></li><li><a href=#at-what-time-does-the-get-request-appear-in-the-nat-isp-side-trace-file>At what time does the GET request appear in the NAT_ISP_side trace file?</a></li><li><a href=#what-are-the-source-and-destination-ip-addresses-and-tcp-source-and-destination-ports-on-the-ip-datagram-carrying-this-http-get-message-as-recorded-in-the-nat-isp-side-trace-file>What are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP GET message (as recorded in the NAT_ISP_side trace file)?</a><ul><li><a href=#which-of-these-fields-are-the-same-and-which-are-different-than-in-your-answer-to-question-2-above>Which of these fields are the same, and which are different, than in your answer to Question 2 above?</a></li><li><a href=#are-any-fields-in-the-http-get-message-changed>Are any fields in the HTTP GET message changed?</a></li></ul></li><li><a href=#which-of-the-following-fields-in-the-ip-datagram-carrying-the-http-get-are-changed-version-header-length-flags-checksum>Which of the following fields in the IP datagram carrying the HTTP GET are changed: Version, Header Length, Flags, Checksum.</a></li><li><a href=#in-the-nat-isp-side-trace-file-at-what-time-is-the-first-200-ok-http-message-received-from-the-google-server>In the NAT_ISP_side trace file, at what time is the first 200 OK HTTP message received from the Google server?</a></li><li><a href=#what-are-the-source-and-destination-ip-addresses-and-tcp-source-and-destination-ports-on-the-ip-datagram-carrying-this-http-200-ok-message-which-of-these-fields-are-the-same-and-which-are-different-than-your-answer-to-question-3-above>What are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP 200 OK message? Which of these fields are the same, and which are different than your answer to Question 3 above?</a></li><li><a href=#in-the-nat-isp-side-trace-file-at-what-time-were-the-client-to-server-tcp-syn-segment-and-the-server-to-client-tcp-syn-ack-segment-corresponding-to-the-segments-in-question-4-and-5-above-captured>In the NAT_ISP_side trace file, at what time were the client-to-server TCP SYN segment and the server-to-client TCP SYN/ACK segment corresponding to the segments in Question 4 and 5 above captured?</a></li><li><a href=#what-are-the-source-and-destination-ip-addresses-and-source-and-destination-ports-for-these-two-segments-tcp-syn-and-tcp-syn-ack>What are the source and destination IP addresses and source and destination ports for these two segments (TCP SYN and TCP SYN/ACK)?</a><ul><li><a href=#tcp-syn>TCP SYN</a></li><li><a href=#tcp-syn-ack>TCP SYN/ACK</a></li></ul></li><li><a href=#the-discussion-on-nat-in-the-week-7-lecture-slide-no-80-shows-the-nat-translation-table-used-by-a-nat-router-using-your-answers-to-the-questions-above-fill-in-the-nat-translation-table-entries-for-the-http-connection-considered-in-the-questions-above>The discussion on NAT in the Week 7 lecture slide No 80 shows the NAT translation table used by a NAT router. Using your answers to the questions above, fill in the NAT translation table entries for the HTTP connection considered in the questions above.</a></li></ul></li><li><a href=#exercise-2-using-wireshark-to-understand-ethernet>Exercise 2: Using Wireshark to understand Ethernet</a><ul><li><a href=#what-is-the-48-bit-ethernet-address-of-the-source-host-of-the-http-get-message-packet>What is the 48-bit Ethernet address of the source host of the HTTP GET message packet?</a></li><li><a href=#what-is-the-48-bit-destination-address-in-the-ethernet-frame-is-this-the-ethernet-address-of-gaia-cs-umass-edu>What is the 48-bit destination address in the Ethernet frame? Is this the Ethernet address of gaia.cs.umass.edu?</a></li><li><a href=#give-the-hexadecimal-value-for-the-two-byte-frame-type-field>Give the hexadecimal value for the two-byte Frame type field.</a></li><li><a href=#how-many-bytes-from-the-very-start-of-the-ethernet-frame-does-the-ascii-apos-g-apos-in-apos-get-apos-appear-in-the-ethernet-frame>How many bytes from the very start of the Ethernet frame does the ASCII &apos;G&apos; in &apos;GET&apos; appear in the Ethernet frame?</a><ul><li><a href=#of-the-bytes-preceding-the-g-the-first-few-bytes-are-the-ethernet-frame-header>Of the bytes preceding the G, the first few bytes are the Ethernet frame header.</a></li><li><a href=#what-are-the-remainder-of-the-bytes-before-the-g>What are the remainder of the bytes before the G?</a></li></ul></li><li><a href=#what-is-the-value-of-the-ethernet-source-address-in-the-http-response-is-this-the-address-of-the-host-that-sent-the-get-http-request-or-of-gaia-cs-umass-edu-if-not-then-which-device-has-this-address>What is the value of the Ethernet source address in the HTTP response? Is this the address of the host that sent the GET HTTP request, or of gaia.cs.umass.edu? If not then which device has this address?</a></li><li><a href=#what-is-the-destination-address-in-the-ethernet-frame-is-this-the-ethernet-address-of-the-source-host-that-sent-the-earlier-get-http-request>What is the destination address in the Ethernet frame? Is this the Ethernet address of the source host that sent the earlier GET HTTP request?</a></li></ul></li><li><a href=#exercise-3-using-wireshark-to-understand-arp>Exercise 3: Using Wireshark to understand ARP</a><ul><li><a href=#what-are-the-hexadecimal-values-for-the-source-and-destination-addresses-in-the-ethernet-frame-containing-the-arp-request-message-is-there-something-special-about-the-destination-address>What are the hexadecimal values for the source and destination addresses in the Ethernet frame containing the ARP request message? Is there something special about the destination address?</a></li><li><a href=#give-the-hexadecimal-value-for-the-two-byte-ethernet-frame-type-field>Give the hexadecimal value for the two-byte Ethernet Frame type field</a></li><li><a href=#how-many-bytes-from-the-very-beginning-of-the-ethernet-frame-does-the-arp-opcode-field-begin>How many bytes from the very beginning of the Ethernet frame does the ARP opcode field begin?</a></li><li><a href=#what-is-the-value-of-the-opcode-field-within-the-arp-payload-part-of-the-ethernet-frame-in-which-an-arp-request-is-made>What is the value of the opcode field within the ARP-payload part of the Ethernet frame in which an ARP request is made?</a></li><li><a href=#does-the-arp-request-message-contain-the-ip-address-of-the-sender>Does the ARP request message contain the IP address of the sender?</a></li><li><a href=#where-in-the-arp-request-does-the-apos-question-apos-ip-address-for-which-the-mapping-is-being-requested-appear>Where in the ARP request does the &apos;question&apos; (IP address for which the mapping is being requested) appear?</a></li><li><a href=#how-many-bytes-from-the-very-beginning-of-the-ethernet-frame-does-the-arp-reply-opcode-field-begin>How many bytes from the very beginning of the Ethernet frame does the ARP reply opcode field begin?</a></li><li><a href=#what-is-the-value-of-the-opcode-field-within-the-arp-payload-part-of-the-ethernet-frame-in-which-an-arp-response-is-made>What is the value of the opcode field within the ARP-payload part of the Ethernet frame in which an ARP response is made?</a></li><li><a href=#where-in-the-arp-message-does-the-apos-answer-apos-to-the-earlier-arp-request-appear-the-ethernet-address-of-the-machine-whose-corresponding-ip-address-is-being-queried>Where in the ARP message does the &apos;answer&apos; to the earlier ARP request appear – the Ethernet address of the machine whose corresponding IP address is being queried?</a></li><li><a href=#what-are-the-hexadecimal-values-for-the-source-and-destination-addresses-in-the-ethernet-frame-containing-the-arp-reply-message>What are the hexadecimal values for the source and destination addresses in the Ethernet frame containing the ARP reply message?</a></li></ul></li></ul></nav></div></div><div class=post-content><h1 id=exercise-1-understanding-nat-using-wireshark>Exercise 1: Understanding NAT using Wireshark</h1><p>File: <a href=./NAT_home_side.pcap>NAT_home_side.pcap</a><br>File: <a href=./NAT_ISP_side.pcap>NAT_ISP_side.pcap</a></p><h2 id=what-is-the-ip-address-of-the-client>What is the IP address of the client?</h2><p><code>192.168.1.100</code></p><h2 id=at-time-7-109267-56-what-are-the-source-and-destination-ip-addresses-and-tcp-source-and-destination-ports-on-the-ip-datagram-carrying-this-http-get>At time 7.109267 (#56), what are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP GET?</h2><p><img src="Screenshot from 2020-04-19 16-55-41.png" alt></p><p>Source: <code>192.168.1.100:4335</code><br>Destination: <code>64.233.169.104:80</code></p><h2 id=at-what-time-is-the-corresponding-200-ok-http-message-received-from-the-google-server>At what time is the corresponding 200 OK HTTP message received from the Google server?</h2><p>At <code>7.158797</code> seconds (packet #60) is received.</p><p>Source: <code>64.233.169.104:80</code><br>Destination: <code>192.168.1.100:4335</code></p><p>The reply to the request is sent back to the client.</p><h2 id=at-what-time-is-the-client-to-server-tcp-syn-segment-sent-that-sets-up-the-connection-used-by-the-get-sent-at-time-7-109267-what-are-the-source-and-destination-ip-addresses-and-source-and-destination-ports-for-the-tcp-syn-segment>At what time is the client-to-server TCP SYN segment sent that sets up the connection used by the GET sent at time 7.109267? What are the source and destination IP addresses and source and destination ports for the TCP SYN segment?</h2><p>At <code>7.075657</code> seconds (packet #53), the SYN segment is sent.</p><p>Source: <code>192.168.1.100:4335</code><br>Destination: <code>64.233.169.104:80</code></p><h2 id=what-are-the-source-and-destination-ip-addresses-and-source-and-destination-ports-of-the-ack-sent-in-response-to-the-syn-at-what-time-is-this-syn-ack-received-at-the-client>What are the source and destination IP addresses and source and destination ports of the ACK sent in response to the SYN. At what time is this SYN/ACK received at the client?</h2><p>The SYN/ACK is received at <code>7.108986</code> seconds (packet #54)</p><p>Source: <code>64.233.169.104:80</code><br>Destination: <code>192.168.1.100:4335</code></p><h2 id=at-what-time-does-the-get-request-appear-in-the-nat-isp-side-trace-file>At what time does the GET request appear in the NAT_ISP_side trace file?</h2><p>The GET request appears at <code>6.069168</code> seconds (packet #85)</p><h2 id=what-are-the-source-and-destination-ip-addresses-and-tcp-source-and-destination-ports-on-the-ip-datagram-carrying-this-http-get-message-as-recorded-in-the-nat-isp-side-trace-file>What are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP GET message (as recorded in the NAT_ISP_side trace file)?</h2><p><img src="Screenshot from 2020-04-19 17-07-54.png" alt></p><p>Source: <code>71.192.34.104:4335</code><br>Destination: <code>64.233.168.104:80</code></p><h3 id=which-of-these-fields-are-the-same-and-which-are-different-than-in-your-answer-to-question-2-above>Which of these fields are the same, and which are different, than in your answer to Question 2 above?</h3><p>The source port, destination IP and destination port have remained the same.<br>The source IP, however, has changed from <code>192.168.1.100</code> to <code>71.192.34.104</code> (WAN address).</p><h3 id=are-any-fields-in-the-http-get-message-changed>Are any fields in the HTTP GET message changed?</h3><p>No, the HTTP layer has remained the same</p><h2 id=which-of-the-following-fields-in-the-ip-datagram-carrying-the-http-get-are-changed-version-header-length-flags-checksum>Which of the following fields in the IP datagram carrying the HTTP GET are changed: Version, Header Length, Flags, Checksum.</h2><blockquote><p>If any of these fields have changed, give a reason (in one sentence) stating why this field needed to change.</p></blockquote><ul><li>Version has remained the same (Version 4)</li><li>Header Length has remained the same (20 bytes)</li><li>Flags have remained the same (0x4000)</li><li>Checksum has CHANGED (0xa94a to 0x022f)<ul><li>As the source IP has changed, a new checksum had to be calculated; hence the checksums will differ</li></ul></li></ul><h2 id=in-the-nat-isp-side-trace-file-at-what-time-is-the-first-200-ok-http-message-received-from-the-google-server>In the NAT_ISP_side trace file, at what time is the first 200 OK HTTP message received from the Google server?</h2><p>The first 200 OK HTTP message transmitted by the Google server (64.233.169.104) was at <code>6.117570</code> seconds (Packet #90).</p><h2 id=what-are-the-source-and-destination-ip-addresses-and-tcp-source-and-destination-ports-on-the-ip-datagram-carrying-this-http-200-ok-message-which-of-these-fields-are-the-same-and-which-are-different-than-your-answer-to-question-3-above>What are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP 200 OK message? Which of these fields are the same, and which are different than your answer to Question 3 above?</h2><p>Source: <code>64.233.168.104:80</code><br>Destination: <code>71.192.34.104:4335</code></p><p>The source port, source IP and destination port have remained the same.<br>The destination IP, however, has changed from <code>192.168.1.100</code> to <code>71.192.34.104</code> (WAN address).</p><h2 id=in-the-nat-isp-side-trace-file-at-what-time-were-the-client-to-server-tcp-syn-segment-and-the-server-to-client-tcp-syn-ack-segment-corresponding-to-the-segments-in-question-4-and-5-above-captured>In the NAT_ISP_side trace file, at what time were the client-to-server TCP SYN segment and the server-to-client TCP SYN/ACK segment corresponding to the segments in Question 4 and 5 above captured?</h2><p>The SYN segment was captured at <code>6.035475</code> seconds (Packet #82).<br>The SYN/ACK segment was captured at <code>6.067775</code> seconds (Packet #83).</p><h2 id=what-are-the-source-and-destination-ip-addresses-and-source-and-destination-ports-for-these-two-segments-tcp-syn-and-tcp-syn-ack>What are the source and destination IP addresses and source and destination ports for these two segments (TCP SYN and TCP SYN/ACK)?</h2><blockquote><p>Which of these fields are the same, and which are different than your answer to Question 4 and 5 above?</p></blockquote><h3 id=tcp-syn>TCP SYN</h3><p>Source: <code>71.192.34.104:4335</code><br>Destination: <code>64.233.168.104:80</code></p><p>Ports are the same, source IP address has changed</p><h3 id=tcp-syn-ack>TCP SYN/ACK</h3><p>Source: <code>64.233.168.104:80</code><br>Destination: <code>71.192.34.104:4335</code></p><p>Ports are the same, destination IP address has changed</p><h2 id=the-discussion-on-nat-in-the-week-7-lecture-slide-no-80-shows-the-nat-translation-table-used-by-a-nat-router-using-your-answers-to-the-questions-above-fill-in-the-nat-translation-table-entries-for-the-http-connection-considered-in-the-questions-above>The discussion on NAT in the Week 7 lecture slide No 80 shows the NAT translation table used by a NAT router. Using your answers to the questions above, fill in the NAT translation table entries for the HTTP connection considered in the questions above.</h2><p>From the home side NAT router:</p><table><thead><tr><th align=center>Local IP</th><th align=center>Local Port</th><th align=center>WAN IP</th><th align=center>WAN Port</th></tr></thead><tbody><tr><td align=center>192.168.1.100</td><td align=center>4335</td><td align=center>71.192.34.104</td><td align=center>4335</td></tr></tbody></table><h1 id=exercise-2-using-wireshark-to-understand-ethernet>Exercise 2: Using Wireshark to understand Ethernet</h1><p>File: <a href=./ethernet-ethereal-trace-1>ethernet-ethereal-trace-1</a></p><h2 id=what-is-the-48-bit-ethernet-address-of-the-source-host-of-the-http-get-message-packet>What is the 48-bit Ethernet address of the source host of the HTTP GET message packet?</h2><p><code>00:d0:59:a9:3d:68</code></p><h2 id=what-is-the-48-bit-destination-address-in-the-ethernet-frame-is-this-the-ethernet-address-of-gaia-cs-umass-edu>What is the 48-bit destination address in the Ethernet frame? Is this the Ethernet address of gaia.cs.umass.edu?</h2><blockquote><p>If not, then which device has this address?<br>Note: this is an important question, and one that students sometimes get wrong. You may want to refer back to relevant parts of the text and lecture notes and make sure you understand the answer here.</p></blockquote><p><code>00:06:25:da:af:73</code></p><p>This is <strong>NOT</strong> the Ethernet address of the server that hosts the website gaia.cs.umass.edu.<br>Rather, this is the Ethernet MAC address of the Linksys brand router that is serving requests for that host.</p><h2 id=give-the-hexadecimal-value-for-the-two-byte-frame-type-field>Give the hexadecimal value for the two-byte Frame type field.</h2><p><code>0x0800</code> (IPv4)</p><h2 id=how-many-bytes-from-the-very-start-of-the-ethernet-frame-does-the-ascii-apos-g-apos-in-apos-get-apos-appear-in-the-ethernet-frame>How many bytes from the very start of the Ethernet frame does the ASCII &apos;G&apos; in &apos;GET&apos; appear in the Ethernet frame?</h2><blockquote><p>Note that when you examine the Data portion of this frame, it actually consists of both the Ethernet frame headers as well as the payload (i.e. bottom window in Wireshark shows the entire 686 byte frame that is captured).</p></blockquote><p>The ASCII &ldquo;G&rdquo; in &ldquo;GET&rdquo; is the 55th byte (Byte number 54, starting from 0).</p><h3 id=of-the-bytes-preceding-the-g-the-first-few-bytes-are-the-ethernet-frame-header>Of the bytes preceding the G, the first few bytes are the Ethernet frame header.</h3><blockquote><p>Does this include the preamble bytes, or are those bytes omitted from the capture?<br>Given this, how many bytes of frame header are present?</p></blockquote><p>The preamble bytes are omitted from the capture.<br>Nothing in the &ldquo;Frame&rdquo; section is shown in the bottom window.</p><h3 id=what-are-the-remainder-of-the-bytes-before-the-g>What are the remainder of the bytes before the G?</h3><ul><li>Byte 0-13: Ethernet</li><li>Byte 14-33: IP<br></li><li>Byte 34-53: TCP</li></ul><h2 id=what-is-the-value-of-the-ethernet-source-address-in-the-http-response-is-this-the-address-of-the-host-that-sent-the-get-http-request-or-of-gaia-cs-umass-edu-if-not-then-which-device-has-this-address>What is the value of the Ethernet source address in the HTTP response? Is this the address of the host that sent the GET HTTP request, or of gaia.cs.umass.edu? If not then which device has this address?</h2><p>In packet #16&hellip;</p><p>The Ethernet source address is <code>00:06:25:da:af:73</code>, which is the address of the Linksys router that the gaia server is behind.</p><h2 id=what-is-the-destination-address-in-the-ethernet-frame-is-this-the-ethernet-address-of-the-source-host-that-sent-the-earlier-get-http-request>What is the destination address in the Ethernet frame? Is this the Ethernet address of the source host that sent the earlier GET HTTP request?</h2><p>The destination MAC address is <code>00:d0:59:a9:3d:68</code>, which is the ethernet address of the source host that send the GET request.</p><h1 id=exercise-3-using-wireshark-to-understand-arp>Exercise 3: Using Wireshark to understand ARP</h1><p>RFC826: <a href=https://www.rfc-editor.org/rfc/rfc826.txt>Link</a><br>ARP Protocol Information: <a href=https://erg.abdn.ac.uk/users/gorry/course/inet-pages/arp.html>Link</a></p><h2 id=what-are-the-hexadecimal-values-for-the-source-and-destination-addresses-in-the-ethernet-frame-containing-the-arp-request-message-is-there-something-special-about-the-destination-address>What are the hexadecimal values for the source and destination addresses in the Ethernet frame containing the ARP request message? Is there something special about the destination address?</h2><p>Source: <code>00:d0:59:a9:3d:68</code><br>Destination: <code>ff:ff:ff:ff:ff:ff</code> - This is a broadcast address which all devices will receive.</p><h2 id=give-the-hexadecimal-value-for-the-two-byte-ethernet-frame-type-field>Give the hexadecimal value for the two-byte Ethernet Frame type field</h2><p><code>0x0806</code> (ARP)</p><h2 id=how-many-bytes-from-the-very-beginning-of-the-ethernet-frame-does-the-arp-opcode-field-begin>How many bytes from the very beginning of the Ethernet frame does the ARP opcode field begin?</h2><p>The 2-byte opcode starts at the 21st byte (bytes 20-21)</p><h2 id=what-is-the-value-of-the-opcode-field-within-the-arp-payload-part-of-the-ethernet-frame-in-which-an-arp-request-is-made>What is the value of the opcode field within the ARP-payload part of the Ethernet frame in which an ARP request is made?</h2><p><code>ares_op$REQUEST = 1 = 0x0001</code></p><h2 id=does-the-arp-request-message-contain-the-ip-address-of-the-sender>Does the ARP request message contain the IP address of the sender?</h2><p>Yes, the ARP request message contains the sender&rsquo;s MAC address (00:d0:59:a9:3d:68) and IP address (192.168.1.105).</p><h2 id=where-in-the-arp-request-does-the-apos-question-apos-ip-address-for-which-the-mapping-is-being-requested-appear>Where in the ARP request does the &apos;question&apos; (IP address for which the mapping is being requested) appear?</h2><p><img src="Screenshot from 2020-04-19 17-58-53.png" alt></p><p>The requested IP appears on the last 4 bytes of the ARP request (bytes 38-41 of the frame)</p><h2 id=how-many-bytes-from-the-very-beginning-of-the-ethernet-frame-does-the-arp-reply-opcode-field-begin>How many bytes from the very beginning of the Ethernet frame does the ARP reply opcode field begin?</h2><p>The 2-byte opcode starts at the 21st byte (bytes 20-21)</p><h2 id=what-is-the-value-of-the-opcode-field-within-the-arp-payload-part-of-the-ethernet-frame-in-which-an-arp-response-is-made>What is the value of the opcode field within the ARP-payload part of the Ethernet frame in which an ARP response is made?</h2><p><code>ares_op$REPLY = 2 = 0x0002</code></p><h2 id=where-in-the-arp-message-does-the-apos-answer-apos-to-the-earlier-arp-request-appear-the-ethernet-address-of-the-machine-whose-corresponding-ip-address-is-being-queried>Where in the ARP message does the &apos;answer&apos; to the earlier ARP request appear – the Ethernet address of the machine whose corresponding IP address is being queried?</h2><p>The answer (Ethernet address 00:06:25:da:af:73) appears in the ARP frame (Bytes 22-27), but also in the Ethernet frame (Bytes 6-11)</p><h2 id=what-are-the-hexadecimal-values-for-the-source-and-destination-addresses-in-the-ethernet-frame-containing-the-arp-reply-message>What are the hexadecimal values for the source and destination addresses in the Ethernet frame containing the ARP reply message?</h2><p>Source: <code>00:06:25:da:af:73</code><br>Destination: <code>00:d0:59:a9:3d:68</code></p></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/lab06/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Lab 06 - Throughput, IP Fragmentation and Routing</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../post/tcp/><span class="next-text nav-default">TCP Protocol</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>